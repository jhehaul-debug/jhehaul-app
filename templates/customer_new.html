{% extends "base.html" %}
{% block title %}Post a Job - JHE Haul{% endblock %}
{% block content %}
<div class="card">
    <h2>Post a Hauling Job</h2>
    <hr>
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    {% for category, message in messages %}
    <div style="padding: 12px 20px; margin-bottom: 15px; border-radius: 6px; {% if category == 'error' %}background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb;{% else %}background: #d4edda; color: #155724; border: 1px solid #c3e6cb;{% endif %}">
        {{ message }}
    </div>
    {% endfor %}
    {% endif %}
    {% endwith %}
    <form method="POST" action="{{ url_for('customer_create') }}" enctype="multipart/form-data" onsubmit="return validateCustomerForm(this);">
        <div class="form-group">
            <label>Your Name</label>
            <input name="customer_name" required value="{{ current_user.first_name or '' }} {{ current_user.last_name or '' }}">
        </div>
        <div class="form-group">
            <label>Your Phone (optional)</label>
            <input name="customer_phone">
        </div>
        <div class="form-group">
            <label>Pickup Address</label>
            <input name="pickup_address" required placeholder="Street Address, City, State">
        </div>
        <div class="form-group">
            <label>Pickup ZIP Code</label>
            <input name="pickup_zip" required placeholder="ZIP Code" maxlength="10">
        </div>
        <div class="form-group">
            <label>Preferred Pickup Date (optional)</label>
            <input type="date" name="preferred_date">
        </div>
        <div class="form-group">
            <label>Preferred Pickup Time (optional)</label>
            <select name="preferred_time">
                <option value="">Any time</option>
                <option value="morning">Morning (8am - 12pm)</option>
                <option value="afternoon">Afternoon (12pm - 5pm)</option>
                <option value="evening">Evening (5pm - 8pm)</option>
            </select>
        </div>
        <div class="form-group">
            <label>What needs hauled?</label>
            <textarea name="job_description" required placeholder="Describe the items, quantity, and any special considerations..."></textarea>
        </div>
        <div class="form-group">
            <label>Upload Photos (optional)</label>
            <input type="file" name="photos" multiple accept="image/*">
        </div>
        <div style="margin: 20px 0; padding: 15px; background: #f8f9fa; border-radius: 8px; border: 1px solid #dee2e6;">
            <label style="display: flex; align-items: flex-start; gap: 10px; cursor: pointer;">
                <input type="checkbox" name="agree_terms" value="1" id="customerTermsCheckbox" style="margin-top: 4px; width: 20px; height: 20px; flex-shrink: 0;">
                <span style="font-size: 0.9rem;">I certify I own or have legal authority over the property and authorize removal of all items. I understand removed items cannot be returned and this forms a legally binding agreement. <a href="{{ url_for('customer_terms') }}" target="_blank" style="color: #007bff; text-decoration: underline;">Read Full Terms</a></span>
            </label>
        </div>
        <button type="submit" class="btn btn-success">Submit Job</button>
    </form>
</div>
<script>
function validateCustomerForm(form) {
    var checkbox = form.querySelector('input[name="agree_terms"]');
    if (!checkbox.checked) {
        alert('You must certify that you own or have legal authority over the property before posting a job.');
        return false;
    }
    return true;
}
</script>
{% endblock %}
